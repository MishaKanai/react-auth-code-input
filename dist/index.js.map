{"version":3,"file":"index.js","sources":["../src/index.tsx"],"sourcesContent":["import React, { useRef, useEffect, useMemo } from 'react';\n\ntype Props = {\n  characters?: number;\n  allowedCharacters?: RegExp;\n  onChange: (res: string) => void;\n  password?: boolean;\n  /**\n   * @deprecated Since version 1.2.0 Will be deleted in version 2.0. Use inputClassName instead.\n   */\n  inputStyle?: React.CSSProperties;\n  /**\n   * @deprecated Since version 1.2.0 Will be deleted in version 2.0. Use containerClassName instead.\n   */\n  containerStyle?: React.CSSProperties;\n  inputClassName?: string;\n  containerClassName?: string;\n  internalLabelPrefix: string;\n  // Element to display below when the code is required, and the values are incomplete\n  RequiredErrorMessage?: JSX.Element | null;\n};\nconst getErrorMessageId = (() => {\n  let id = 1;\n  return () => {\n    return 'authcode-errormessage-' + id++;\n  };\n})();\nconst AuthCode: React.FC<Props> = ({\n  characters = 6,\n  allowedCharacters = '^[A-Za-z0-9]*$',\n  onChange,\n  password,\n  inputStyle,\n  containerStyle,\n  inputClassName,\n  containerClassName,\n  internalLabelPrefix,\n  RequiredErrorMessage\n}) => {\n  const errormessageId = useMemo(() => getErrorMessageId(), []);\n  const inputsRef = useRef<Array<HTMLInputElement>>([]);\n\n  useEffect(() => {\n    inputsRef.current[0].focus();\n  }, []);\n\n  const sendResult = () => {\n    const res = inputsRef.current.map((input) => input.value).join('');\n    onChange(res);\n  };\n\n  const handleOnChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    if (e.target.value.match(allowedCharacters)) {\n      if (e.target.nextElementSibling !== null) {\n        (e.target.nextElementSibling as HTMLInputElement).focus();\n      }\n    } else {\n      e.target.value = '';\n    }\n    sendResult();\n  };\n\n  const handleOnKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n    const { key } = e;\n    const target = e.target as HTMLInputElement;\n    if (key === 'Backspace') {\n      if (target.value === '' && target.previousElementSibling !== null) {\n        if (target.previousElementSibling !== null) {\n          (target.previousElementSibling as HTMLInputElement).focus();\n          e.preventDefault();\n        }\n      } else {\n        target.value = '';\n      }\n      sendResult();\n    }\n  };\n\n  const handleOnFocus = (e: React.FocusEvent<HTMLInputElement>) => {\n    e.target.select();\n  };\n\n  const handleOnPaste = (e: React.ClipboardEvent<HTMLInputElement>) => {\n    const value = e.clipboardData.getData('Text');\n    if (value.match(allowedCharacters)) {\n      for (let i = 0; i < characters && i < value.length; i++) {\n        inputsRef.current[i].value = value.charAt(i);\n        if (inputsRef.current[i].nextElementSibling !== null) {\n          (inputsRef.current[i].nextElementSibling as HTMLInputElement).focus();\n        }\n      }\n      sendResult();\n    }\n    e.preventDefault();\n  };\n\n  const inputs = [];\n  for (let i = 0; i < characters; i++) {\n    inputs.push(\n      <input\n        key={i}\n        aria-label={`${internalLabelPrefix} character ${\n          i + 1\n        } of ${characters}`}\n        aria-describedby={\n          !inputsRef.current?.[i]?.value && RequiredErrorMessage\n            ? errormessageId\n            : undefined\n        }\n        onChange={handleOnChange}\n        onKeyDown={handleOnKeyDown}\n        onFocus={handleOnFocus}\n        onPaste={handleOnPaste}\n        type={password ? 'password' : 'text'}\n        ref={(el: HTMLInputElement) => (inputsRef.current[i] = el)}\n        maxLength={1}\n        className={inputClassName}\n        style={inputStyle}\n      />\n    );\n  }\n\n  return (\n    <div className={containerClassName} style={containerStyle}>\n      {inputs}\n      {RequiredErrorMessage && (\n        <div id={errormessageId}>{RequiredErrorMessage}</div>\n      )}\n    </div>\n  );\n};\n\nexport default AuthCode;\n"],"names":["getErrorMessageId","id","AuthCode","characters","allowedCharacters","onChange","password","inputStyle","containerStyle","inputClassName","containerClassName","internalLabelPrefix","RequiredErrorMessage","errormessageId","useMemo","inputsRef","useRef","useEffect","current","focus","sendResult","res","map","input","value","join","handleOnChange","e","target","match","nextElementSibling","handleOnKeyDown","key","previousElementSibling","preventDefault","handleOnFocus","select","handleOnPaste","clipboardData","getData","i","length","charAt","inputs","push","React","undefined","onKeyDown","onFocus","onPaste","type","ref","el","maxLength","className","style"],"mappings":"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"}